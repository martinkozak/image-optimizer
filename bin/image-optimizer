#!/bin/env ruby
# encoding: utf-8
# (c) 2011-2012 Martin Kozák (martinkozak@martinkozak.net)

require "image-optimizer"
require "yaop"

# Parses command line
opts = YAOP::get do
    option "--help"
    type Boolean, false
    
    option "--version"
    type Boolean, false
    
    option "--silent"
    type Boolean, false
end

# Shows help or version
if opts.arguments["--help"]
    puts "Usage: image-optimizer <arguments> [files or folders]*"
    puts "\t--help     display this help and exit"
    puts "\t--version  output version information and exit"
    puts "\t--silent   doesn't write anything to output
    exit
elsif opts.arguments["--version"]
    puts "image-optimizer 0.2.0"
    puts "Copyright (C) 2011-2012 Martin Kozák (martinkozak@martinkozak.net)"
    puts "Optimizes given JPEG and PNG images or all images in given folders."
    exit
end

# Optimizes
ImageOptimizer::optimize(opts.parameters) do |i|
    if not opts.arguments["--silent"]
        puts i << "\n"
    end
end
